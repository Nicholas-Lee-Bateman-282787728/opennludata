(this["webpackJsonpchatui-example"]=this["webpackJsonpchatui-example"]||[]).push([[0],{144:function(e,t,n){var a=n(166);e.exports=a,window.voicedialogjs=a},145:function(e,t,n){e.exports=n(281)},146:function(e,t,n){},166:function(e,t,n){var a=n(167),r=r||{},s=s||null;r.gapi=s;var i=n(59).NeuralNetwork,o=n(172);r.searchYouTube=o;var l=n(183);e.exports=function(e){var t=[],s={},o=null,u={},c=e.utterances,f=null,p={},m=new i,d=null;function h(e){e&&e.name&&(t.push("intent "+e.name),Array.isArray(e.entities)&&e.entities.map((function(e){e.name&&(t.push("slot_"+e.name),s[e.name]=e.value)})))}function y(e){return new Promise((function(t,n){m.train(e),t()}))}function g(e){var t=[];return Array.isArray(e)&&e.length>0&&e.map((function(e){e.steps&&e.steps.map((function(n,a){if(a>0&&0===n.indexOf("utter ")||0===n.indexOf("action ")){var r=e.steps.slice(0,a),s=e.steps[a];t.push({input:b(r),output:b([s])})}}))})),t}function v(){var e=function(e){var t={};return e.map((function(e){return t[e]=1,null})),t}(t),n=m.run(e);if(n&&Object.keys(n).length>0){var a=Object.keys(n).map((function(e){return{next:e,score:n[e]}})).sort((function(e,t){return e.score>t.score?-1:1}));return a.length>0?a[0].next:""}return null}function b(e){var t={};return Array.isArray(e)&&e.length>0&&e.map((function(e){return t[e]=1,null})),t}function w(e,t){var n=JSON.parse(JSON.stringify(e));e&&e.synonym&&Object.keys(t).map((function(a){n.synonym=e.synonym.replace(new RegExp("{"+a+"}","g"),t[a])})),e&&e.buttons&&e.buttons.map((function(e,a){Object.keys(t).map((function(e){n.buttons[a].label=n.buttons[a].label?n.buttons[a].label.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.buttons[a].utterance=n.buttons[a].utterance?n.buttons[a].utterance.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.buttons[a].link=n.buttons[a].link?n.buttons[a].link.replace(new RegExp("{"+e+"}","g"),t[e]):""}))})),e&&e.texts&&e.texts.map((function(e,a){Object.keys(t).map((function(e){n.texts[a].label=n.texts[a].label?n.texts[a].label.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.texts[a].text=n.texts[a].text?n.texts[a].text.replace(new RegExp("{"+e+"}","g"),t[e]):""}))})),e&&e.images&&e.images.map((function(e,a){Object.keys(t).map((function(e){n.images[a].label=n.images[a].label?n.images[a].label.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.images[a].href=n.images[a].href?n.images[a].href.replace(new RegExp("{"+e+"}","g"),t[e]):""}))})),e&&e.audio&&e.audio.map((function(e,a){Object.keys(t).map((function(e){n.audio[a].label=n.audio[a].label?n.audio[a].label.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.audio[a].href=n.audio[a].href?n.audio[a].href.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.audio[a].start=n.audio[a].start?n.audio[a].start.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.audio[a].end=n.audio[a].end?n.audio[a].end.replace(new RegExp("{"+e+"}","g"),t[e]):""}))})),e&&e.video&&e.video.map((function(e,a){Object.keys(t).map((function(e){n.video[a].label=n.video[a].label?n.video[a].label.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.video[a].href=n.video[a].href?n.video[a].href.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.video[a].start=n.video[a].start?n.video[a].start.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.video[a].end=n.video[a].end?n.video[a].end.replace(new RegExp("{"+e+"}","g"),t[e]):""}))})),e&&e.frames&&e.frames.map((function(e,a){Object.keys(t).map((function(e){n.frames[a].label=n.frames[a].label?n.frames[a].label.replace(new RegExp("{"+e+"}","g"),t[e]):"",n.frames[a].href=n.frames[a].href?n.frames[a].href.replace(new RegExp("{"+e+"}","g"),t[e]):""}))}));var a=n&&n.synonym?n.synonym.split("\n"):[];if(n){var r=a.length>0?a[Math.floor(Math.random()*a.length)]:"";n.utterance=r}return n}function x(n,a="",r){var i=[];return new Promise((function(a,l){n&&n.slots&&Object.keys(n.slots).map((function(e){var a=n.slots[e];t.push("slot "+e),s[e]=a}));var u=n&&n.name?"intent "+n.name:"";"intent None"===u&&(u="intent fallback");var f=null;if(e.rules.map((function(e){if(!f&&Array.isArray(e.steps)&&e.steps.length>0&&0===e.steps[0].indexOf("intent ")){e.steps[0].slice(7);if(e.steps[0]===u){var n=!0;e.conditions&&e.conditions.length>0&&e.conditions.map((function(e){if(0===e.indexOf("is_conversation_start "))t.length>0&&(n=!1);else if(0===e.indexOf("has_slot ")){var a=e.slice(9);s.hasOwnProperty(a)&&null!==s[a]&&void 0!==s[a]||(n=!1)}else if(0===e.indexOf("active_form ")){var r=e.slice(12);o&&o.name===r||(n=!1)}})),n&&(f=e)}}})),f&&f.steps&&f.steps.length>0){t.push(u),function n(a,r,i,l){return new Promise((function(u,f){if(Array.isArray(r)&&r.length>0){var p=r[0];(function(n,a,r){var i=[];return new Promise((function(l,u){if(a&&0===a.indexOf("action ")){t.push(a);var f=a.slice(7);e.actions&&(e.actions[f],1)?P(n,f,r).then((function(e){l(e)})):l(i)}else if(a&&0===a.indexOf("utter ")){f=a.slice(6);if(c&&c[f]){t.push(a);var p=w(c[f],s);i.push(p),r?r(p).then((function(){l(i)})):l(i)}else l(i)}else if(a&&0===a.indexOf("form ")){f=a.slice(5);if(e.forms&&e.forms[f]){t.push(a),o={name:f};var m=[].concat(i,N(r));l(m)}else o=null,l(i)}else l(i)}))})(a,p,l).then((function(e){Array.isArray(e)&&e.map((function(e){i.push(e)})),p&&(0===p.indexOf("action ")||p.indexOf(!1)||p.indexOf(!1))?n(a,r.slice(1),i,l).then((function(e){u(i)})):u(i)}))}else u(i)}))}(n,f.steps.slice(1),i,r).then((function(e){a(e)}))}else if(o)a(N(n,r));else{h(n);var p=null;(function n(a,r,i){return new Promise((function(l,u){var f=v();!f||f===p||0!==f.indexOf("action ")&&0!==f.indexOf("utter ")&&0!==f.indexOf("form ")&&0!==f.indexOf("slot ")?l(r):(p=f,function(n,a,r){var i=[];return new Promise((function(l,u){if(0===a.indexOf("action "))e.actions&&"function"===typeof e.actions[a]?(t.push(a),e.actions[a](t,s,e).then((function(e,n){Array.isArray(n)&&n.map((function(e){t.push("slot "+e.name),s[e.name]=e.value})),Array.isArray(e)?e.map((function(n){var a="utter "+n;t.push(a);var r=w(c[n],s);e.push(r),l(e)})):l(e)}))):l(i);else if(a.indexOf(!1)){var f=a.slice(6);if(c&&c[f]){t.push(a);var p=w(c[f],s),m=Array.isArray(p)?p[Math.floor(Math.random()*p.length)]:"";Object.keys(s).map((function(e){m=m.replace(new RegExp("{"+e+"}","g"),s[e])})),m=m.replace(new RegExp("\\{.*\\}","g"),""),r?r(p).then((function(){l(i)})):l(i)}else l(i)}else if(0===a.indexOf("form ")){f=a.slice(5);e.forms&&e.forms[f]?(t.push(a),o={name:f},l(N(n,r))):(o=null,l(N(n,r)))}else l(i)}))}(f,i).then((function(e){!(f=v())||0!==f.indexOf("action ")&&0!==f.indexOf("utter ")&&0!==f.indexOf("form ")&&0!==f.indexOf("slot ")?l(e):n(a,e,i).then((function(e){l(e)}))})))}))})(i,r).then((function(e){a(e)}))}}))}function E(e,t){s[e]=t}function k(){t=[],s=[],o=null}function O(e,n){t=[],o=null}function S(){t.pop(),console.log(["back"])}function A(){console.log(["listen"])}function j(){console.log(["no listen"])}function R(e){e?(o={name:e},console.log(["form"])):o=null}function P(n,a,i){return new Promise((function(o,u){var f=[];try{var p={replaceMarkersInUtterance:w,axios:l},m=e&&e.actions&&e.actions[a]?e.actions[a]:{};if(m&&m.synonym){var d=new Function("intent","history","slots","config","handleBotMessage","utils","window","slot","reset","restart","back","listen","nolisten","form","\n                    var apis={}\n                    return new Promise(function(resolve,reject) {\n                        var output = []; \n                        //var slots = {};\n                        \n                        function response(utterance,forceSlots) {\n                        //console.log(['API RESPOSNE',utterance,slots,config.utterances,utterance])\n                            return new Promise(function(iresolve,ireject) {\n                                if (config.utterances[utterance])  {\n                                    var useSlots = {}\n                                    if (slots) Object.keys(slots).map(function(slot) {useSlots[slot] = slots[slot]})\n                                    if (forceSlots) Object.keys(forceSlots).map(function(slot) {useSlots[slot] = forceSlots[slot]})\n                                    //console.log(['API RESPOSNE merge slots',\n                                    //slots ? JSON.parse(JSON.stringify(slots)) : null,\n                                    //forceSlots ? JSON.parse(JSON.stringify(forceSlots)) : null, \n                                    //useSlots ? JSON.parse(JSON.stringify(useSlots)) : null\n                                    //])\n                                    \n                                    var templates = utils.replaceMarkersInUtterance(config.utterances[utterance],useSlots)\n                                    //console.log(['API RESPOSNE have utt',templates,handleBotMessage])\n                                    output.push(templates)\n                                    if (handleBotMessage) {\n                                        //console.log(['API HAN RESPOSNE hbm',JSON.parse(JSON.stringify([utterance,templates,slots])) ])\n                                        handleBotMessage(templates).then(function() {\n                                            //console.log(['API RESPOSNE hbm DONE',slots,output])\n                                            iresolve()\n                                        })\n                                    } else {\n                                        iresolve()\n                                    }\n                                } else {\n                                //console.log(['API RESPOSNE NO utt'])\n                                    iresolve()\n                                }\n                            })\n                                \n                        }\n                        function api(apiKey) {\n                            var final = {}\n                            if (apiKey && apiKey.trim() && config && config.apis.hasOwnProperty(apiKey) && config.apis[apiKey].synonym && config.apis[apiKey].synonym.trim()) {\n                                var apiInstance = null \n                                if (apis[apiKey]) {\n                                    apiInstance = apis[apiKey]\n                                } else {\n                                    try {\n                                        apiInstance = new Function('intent','history','slots','config','utils','window','slot','response','api','reset','restart','back','listen','nolisten','form', config.apis[apiKey].synonym.trim())\n                                        \n                                    } catch (e) {\n                                        console.log(e)\n                                    }\n                                }\n                                var final = {}\n                                try {\n                                    if (typeof apiInstance === 'function') {\n                                        final = apiInstance(intent,history,slots,config,utils, window,slot,response,api,reset,restart,back,listen,nolisten,form) \n                                    }\n                                } catch (e) {\n                                    console.log(e)\n                                }\n                            }\n                            return final\n                        }\n                        \n                         try {\n                        "+m.synonym+"\n                        } catch (e) {\n                            console.log(e)\n                        }\n                       \n                    })\n                ")(n,t,s,e,i,p,r,E,k,O,S,A,j,R);d.then?d.then((function(e,n){Array.isArray(n)&&n.map((function(e){t.push("slot "+e.name),s[e.name]=e.value})),Array.isArray(e)&&e.map((function(n){var a="utter_"+n.value;if(t.push(a),c.hasOwnProperty(n.value)){var r=w(c[n.value],s);e.push(r)}else console.log("Response "+n.value+" non found")})),o(e)})):(console.log("An action function must return a promise"),o(f))}else"listen"===a?A():"nolisten"===a?j():"reset"===a?k():"restart"===a?O():"back"===a&&S(),o(f)}catch(h){console.log(h),o(f)}}))}function N(t,n){return new Promise((function(a,r){var i=[],l=!0,u=null;if(o&&o.name&&e.forms&&e.forms.hasOwnProperty(o.name)&&e.forms[o.name]){var c=e.forms[o.name];if(Array.isArray(c.slots)&&c.slots.map((function(e){var n=!1;Array.isArray(e.capturefrom)&&e.capturefrom.map((function(e){"from entity"===e.type&&e.entity?t.entities&&t.entities.map((function(t){t.entity&&t.entity===e.entity&&(o.data=o.data?o.data:{},o.data[t.entity]=t.option,n=!0)})):e.entity&&"from text"===e.type&&f&&f.trim()?(o.data=o.data?o.data:{},o.data[e.entity]=f,n=!0):t.intent&&"from intent"===e.type&&e.value&&Array.isArray(e.intent)?-1!==e.intent.indexOf(t.intent)&&(o.data=o.data?o.data:{},o.data[e.entity]=e.value,n=!0):"from trigger intent"===e.type&&-1!==e.intent.indexOf(t.intent)&&(o.data=o.data?o.data:{},o.data[e.entity]=e.value,n=!0)})),n||u||(u=e.text),l=l&&n})),l)o=null,c&&c.finished?P(t,c.finished,n).then((function(e){a(e)})):a(i);else if(e.utterances[u]){var p=w(e.utterances[u],s);i.push(p),n?n(p).then((function(){a(i)})):a(i)}else a(i)}else a(i)}))}return{init:function(){var t=this;return new Promise((function(r,s){function o(e){e?x({name:"welcome"},"",t.handleBotMessage).then((function(e){r(e)})):r([])}var l=!1;Array.isArray(e.rules)&&e.rules.map((function(e){Array.isArray(e.steps)&&e.steps.length>0&&0===e.steps[0].indexOf("intent ")&&(u[e.steps[0]+(e.conditions?JSON.stringify(e.conditions):"")]=e,"welcome"===e.steps[0].slice(7)&&(l=!0))})),n(200)().then((function(t){(d=t).train(e).then((function(){e.json&&Object.keys(e.json).length>0?(a("model"),(m=new i).fromJSON(e.json),o(l)):e.corpus&&Object.keys(e.corpus).length>0?y(e.corpus).then((function(){o(l)})):e.stories&&Object.keys(e.stories).length>0||e.rules&&Object.keys(e.rules).length>0?y(g(e.stories)).then((function(){o(l)})):r("no training data")}))}))}))},pushIntent:h,pushEntity:function(e){e.name&&(t.push("slot "+e.name),s[e.name]=e.value)},pushAction:function(e){e.name&&t.push("action "+e.name)},pushUtterance:function(e){e.name&&t.push("utter "+e.name)},resetHistory:function(){t=[]},train:y,predict:v,arrayToWeights:b,run:function(e,t,n){var a=this;return new Promise((function(t,n){if("string"===typeof e){if(f=e,!d)throw new Error("Cannot handle string intent without a manager configured");try{d.process(e).then(n=>{p.name=n.intent,p.entities=n.entities,p.slots=n.slots,x(p,e,a.handleBotMessage).then((function(e){t(e)}))}).catch((function(e){console.log(e)}))}catch(r){console.log(r)}}else"object"===typeof e&&e.name&&e.name.trim()&&(f="",x(p=e,"",a.handleBotMessage).then((function(e){t(e)})))}))},fromStories:g,history:t,setHistory:function(e){t=e},slots:s,model:m,toJSON:function(){return{nlp:d.toJSON(),core:m.toJSON()}},manager:d,currentForm:o,slot:E}}},200:function(e,t,n){var a=n(1),r=n(2),s=n(202).containerBootstrap,i=n(210).Nlp,o=n(99).Ner,l=n(271).LangEn;function u(){return(u=r(a.mark((function e(){var t,n,u,c,f,p,m,d,h;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h=function(){return(h=r(a.mark((function e(n){var r,s,i,o;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.process("en",n);case 2:return r=e.sent,s={},i={},e.next=7,t.process({locale:"en",text:n});case 7:return o=e.sent,r&&r.intent&&c.hasOwnProperty(r.intent)&&c[r.intent]&&Array.isArray(o.entities)&&Object.keys(c[r.intent]).map((function(e){o.entities.map((function(t){if(t.entity===e){i[e]=i[e]?parseInt(i[e])+1:0;var n=e;i[e]>0&&(n=e+"_"+i[e]),t.option&&(s[n]=t.option)}}))})),r.entities=o.entities,r.slots=s,e.abrupt("return",r);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)},d=function(e){return h.apply(this,arguments)},m=function(){return{nlp:JSON.parse(u.export()),core:t.getRules(),intentEntities:c}},p=function(){return(p=r(a.mark((function e(n){var r,s;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},s={},!n.intents){e.next=7;break}return Object.keys(n.intents).map((function(e){var t=n.intents[e];if(Array.isArray(t)){t.map((function(t){var n=t.example;if(Array.isArray(t.entities)){var a=t.entities.sort((function(e,t){return e.start<t.start?-1:1})),i=0;a.map((function(t){s[t.type]=s[e]?s[e]:[],s[t.type].push({value:t.value}),c[e]=c[e]?c[e]:{},c[e][t.type]=1,n=n.slice(0,t.start+i)+"%"+t.type+"%"+n.slice(t.end+i);var a=t.end-t.start-(t.type.length+2);return i-=a,null}))}r[n]=e}))}})),Object.keys(r).map((function(e){var t=r[e];u.addDocument("en",e,t)})),e.next=7,u.train();case 7:Array.isArray(n.regexps)&&n.regexps.map((function(e){if(e.entity&&e.entity.trim())try{t.addRegexRule("en",e.entity,e.synonym)}catch(n){console.log(n)}})),n.entities&&n.entitiesData&&Object.keys(n.entities).map((function(e){var t=n.entities[e];s[e]=s[e]?s[e]:[],t.values&&t.values.map((function(t){s[e].push({value:t})})),t.lists&&t.lists.map((function(t){Array.isArray(n.entitiesData[t])&&n.entitiesData[t].map((function(t){s[e].push(t)}))}))})),Object.keys(s).map((function(e){var n=s[e];if(Array.isArray(n)){var a={},r={};n.map((function(e){return e.synonym&&e.synonym.trim()?(a[e.synonym]=a[e.synonym]?a[e.synonym]:[],a[e.synonym].push(e.value)):r[e.value]=1,null})),Object.keys(a).map((function(n){t.addRuleOptionTexts("en",e,n,[n]),t.addRuleOptionTexts("en",e,n,a[n])})),Object.keys(r).map((function(n){t.addRuleOptionTexts("en",e,n,[n])}))}}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)},f=function(e){return p.apply(this,arguments)},t=new o,e.next=8,s();case 8:return(n=e.sent).use(i),n.use(l),(u=n.get("nlp")).settings.autoSave=!1,u.settings.autoLoad=!1,u.settings.forceNER=!0,u.addLanguage("en"),c={},e.abrupt("return",{train:f,process:d,toJSON:m});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.exports=function(){return u.apply(this,arguments)}},280:function(e,t){e.exports={id:"5f9f9ca1765669f74d87c048",title:"image search",invocation:"",entities:{imageSearch:{values:["factory","flock of seagulls","galaxies","jlkj4lkj","kittens","mountain range","pigs","space station","sunset"]}},intents:{"show picture":[{example:"show me a picture of jlkj4lkj",entities:[{type:"imageSearch",value:"jlkj4lkj",start:21,end:29}]},{example:"show me a factory",entities:[{type:"imageSearch",value:"factory",start:10,end:17}]},{example:"do you have a picture of a flock of seagulls",entities:[{type:"imageSearch",value:"flock of seagulls",start:27,end:44}]},{example:"find pictures of a mountain range",entities:[{type:"imageSearch",value:"mountain range",start:19,end:33}]},{example:"show me photos of sunset",entities:[{type:"imageSearch",value:"sunset",start:18,end:24}]},{example:"i want to see some kittens",entities:[{type:"imageSearch",value:"kittens",start:19,end:26}]},{example:"show me pictures of pigs",entities:[{type:"imageSearch",value:"pigs",start:20,end:24}]},{example:"give me an image of a space station",entities:[{type:"imageSearch",value:"space station",start:22,end:35}]},{example:"show me pictures of galaxies",entities:[{type:"imageSearch",value:"galaxies",start:20,end:28}]}]},entitiesData:{},forms:{},actions:{"search unsplash":{id:"5f9f9d4970539919455a1cdc",value:"search unsplash",synonyms:"",tags:[],apis:[{text:"unsplash",functionCall:"showResults"}],synonym:"\nvar entities = intent && intent.slots ? intent.slots : {}\nvar criteria = entities['imageSearch'] ? entities['imageSearch'] : ''\n//console.log(['CROTEROA',criteria])\n\napi('unsplash').search(criteria).then(function(result) {\n    api('unsplash').showResults().then(function(result) {\n        resolve(output,slots)\n    })\n    \n})\n\n",responses:[{text:"search unsplash waiting"}]}},apis:{unsplash:{id:"5f9fde2da3b40678386bdb4a",value:"unsplash",synonym:"console.log(['unsplash api',window])\n\n\nvar apiKey=\"rdQcxo3iExmblvSDF16A8gBMc5zXQLgk3yEkXk7FFks\"\n\n\nfunction search(criteria, limit=5 ,skip=0) {\n    slot('criteria',criteria)\n        console.log(['API SEARCH CRITERIA',criteria])\n            //+ (skip > 0 ? '&page='+skip/(limit>0 ? limit : 1) : '') +(limit > 0 ? '&per_page='+limit : '') \n    return new Promise(function(resolve,reject) {\n        if (!criteria) {\n            response('unsplash what do you want to see').then(function() {resolve()})\n        } else {\n            response('search unsplash waiting').then(function() {\n                var url='https://api.unsplash.com/search/photos/?client_id='+apiKey+'&per_page=5&query='+criteria ;\n                console.log(url)\n                utils.axios.get(url).then(function(res) {\n                    //console.log(['UNSP RES'])\n                    console.log(['UNSP RES',res])\n                    if (res && res.data && Array.isArray(res.data.results) && res.data.results.length > 0) { \n                        slot('unsplashResults',JSON.stringify(res && res.data && res.data.results  ? res.data.results : []))\n                        resolve(res)  \n                    } else {\n                        response('unsplash not found').then(function() {resolve()})\n                    }\n                })\n            })\n        }\n       //resolve()\n    })\n}\n\n\nfunction showResults() {\n    console.log(['SHOW RES',slots['unsplashResults']])\n    \n    var results= []\n    try {\n        if (slots['unsplashResults']) results = JSON.parse(slots['unsplashResults'])\n    } catch (e) {\n        console.log(e)\n    }\n    return new Promise(function(resolve,reject) {\n        console.log(['PICS',results]);\n        if (Array.isArray(results)) {\n            var promises = []\n            results.map(function(result) {\n                console.log(['PIC',result]);\n                if (result && result.urls && result.urls.regular) {\n                    console.log(['PIC',result.urls.regular]);\n                    promises.push(response('show unsplash images',{unsplashImage: result.urls.regular}))\n                }\n            })\n           // slot('playingYoutubeVideo','https://www.youtube.com/embed/'+ videos[0].id.videoId)\n            Promise.all(promises).then(function(allRes) {\n                resolve()\n            })\n        }\n    })\n} \n\nreturn {\n     search: search, showResults: showResults\n}\n// return object containing api functions\nreturn {\n    test : function() {\n        console.log(test)\n     }\n}",tags:[],responses:[{text:"show unsplash images"},{text:"unsplash what do you want to see"},{text:"unsplash not found"}]}},utterances:{"unsplash not found":{id:"5fa07bc2ce3fd15548faad7a",value:"unsplash not found",synonym:"I couldn't find any images matching {criteria}",tags:[]},"unsplash what do you want to see":{id:"5fa079aff85b0facf559bffa",value:"unsplash what do you want to see",synonym:"what do you want to see ?",tags:[]},"search unsplash waiting":{id:"5f9fc6025cc8011bd7e4cb06",value:"search unsplash waiting",synonym:"loading",tags:[]},"show unsplash images":{id:"5f9f9f762d76166791c02d79",value:"show unsplash images",synonym:"",tags:[],buttons:[],images:[{label:"",href:"{unsplashImage}",youtubeVideoId:"{unsplashImage}",start:"",end:""}]},"i can show pictures":{id:"5f9f9d3282a50b5486b11ef3",value:"i can show pictures",synonym:"",tags:[],buttons:[{label:"show me pictures of the space station",utterance:"",link:""},{label:"i want to see some kittens",utterance:"",link:""},{label:"show me pictures of pigs",utterance:"",link:""},{label:"show me a mountain range",utterance:"",link:""},{label:"photo of a flock of seagulls",utterance:"",link:""},{label:"show me a picture of jlkj4lkj",utterance:"",link:""}]}},rules:[{rule:"welcome",steps:["intent welcome","utter i can show pictures"]},{rule:"show me pictures",steps:["intent show picture","action search unsplash"]}]}},281:function(e,t,n){"use strict";n.r(t);n(146);var a=n(0),r=n.n(a),s=n(141),i=n.n(s),o=n(13),l=n(283),u=n(57),c=n(144),f=n.n(c);var p=e=>{function t(t){e.sendUserMessage&&e.sendUserMessage(t)}var n=e.history,a="true"===localStorage.getItem("mute_chat");return r.a.createElement("div",{style:{border:"1px solid black",padding:"0.2em",width:"100%"}},n.length>0&&r.a.createElement("div",{className:"history",style:{padding:"0.2em",width:"100%",marginTop:"0.5em"}},[].concat(n).reverse().map((function(e,n){return r.a.createElement("div",{style:{borderTop:"3px solid black",marginTop:"0.1em",padding:"0.2em",width:"100%"},key:n},!1,e.user&&r.a.createElement("span",{style:{marginBottom:"1em",marginTop:"1em",padding:"0.2em",width:"100%"}},r.a.createElement("hr",null),r.a.createElement("b",null,"User: "),r.a.createElement("button",{onClick:function(){t(e.user)}},r.a.createElement("i",null,e.user))),Array.isArray(e.bot)&&r.a.createElement("div",null,e.bot.map((function(e,n){return r.a.createElement("div",{key:n},e&&e.utterance&&r.a.createElement("div",null,r.a.createElement("b",null,"Bot: "),r.a.createElement("span",null,e.utterance)),e&&e.buttons&&r.a.createElement("div",{style:{margin:"0.5em"}},e.buttons.map((function(e,n){return r.a.createElement("button",{key:n,onClick:function(n){n.preventDefault(),t(e.text?e.text:e.label)}},e.label)}))),e&&e.images&&r.a.createElement("div",{style:{margin:"0.5em"}},e.images.map((function(e,t){return r.a.createElement("img",{key:t,src:e.href,style:{width:"100%"}})}))),e&&e.texts&&r.a.createElement("div",{style:{margin:"0.5em"}},e.texts.map((function(e,t){return r.a.createElement("div",{key:t},e.text)}))),e&&e.audio&&r.a.createElement("div",{style:{margin:"0.5em"}},e.audio.map((function(e,t){return"true"!==e.autoplay||a?r.a.createElement("audio",{key:t,src:e.href,controls:!0}):r.a.createElement("div",{key:t})}))),e&&e.video&&r.a.createElement("div",{style:{margin:"0.5em"}},e.video.map((function(e,t){if("true"!==e.autoplay||a){var n=e&&e.href?void 0!==(i=(i=e.href).split(/(vi\/|v%3D|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]?i[2].split(/[^0-9a-z_\-]/i)[0]:i[0]:"";if(n){var s={playerVars:{start:e.start,end:e.end,controls:1,autoplay:0}};return r.a.createElement(u.a,{key:t,videoId:n,opts:s})}return r.a.createElement("video",{style:{height:"150px"},key:t,src:e.href,controls:!0})}return r.a.createElement("div",{key:t});var i}))),e&&e.frames&&r.a.createElement("div",{style:{margin:"0.5em"}},e.frames.map((function(e,t){return r.a.createElement("iframe",{style:{width:"100%",height:"400px"},key:t,src:e.href})}))))}))))}))))};function m(e){var t={position:"relative",backgroundColor:e.color?e.color:"grey",border:"2px solid black",borderRadius:"1em",height:"2em",width:"2em",textDecoration:"none",outline:"none"};return e.style&&(t=Object.assign(t,e.style)),r.a.createElement("button",{id:"microphone_button",onClick:function(e){e.preventDefault()},style:t},r.a.createElement("div",{style:{position:"relative",width:"85%",top:"0.1em",left:"0.1em"}},r.a.createElement("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"microphone",className:"svg-inline--fa fa-microphone fa-w-11",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 352 512"},r.a.createElement("path",{fill:"currentColor",d:"M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z"}))))}var d=window.meSpeak;function h(e){var t=Object(a.useRef)(null),n=(Object(a.useRef)(null),Object(a.useState)(!1)),s=Object(o.a)(n,2),i=s[0],c=s[1],h=Object(a.useState)(!1),y=Object(o.a)(h,2),g=(y[0],y[1],Object(a.useState)(null)),v=Object(o.a)(g,2),b=v[0],w=v[1],x=Object(a.useState)(!1),E=Object(o.a)(x,2),k=E[0],O=E[1],S=Object(a.useState)([]),A=Object(o.a)(S,2),j=A[0],R=A[1],P=Object(a.useState)(null),N=Object(o.a)(P,2),C=N[0],I=N[1],L=Object(a.useState)(null),M=Object(o.a)(L,2),J=M[0],T=M[1],V=Object(a.useState)(""),_=Object(o.a)(V,2),B=_[0],H=_[1],D=e.currentSkill,F=null,K=Object(a.useState)(null),z=Object(o.a)(K,2),W=(z[0],z[1]);function U(e){e&&(d.stop(),F&&F.pause(),t&&t.current&&(t.current.pause(),I(null))),localStorage.setItem("mute_chat",!!e&&"true"),O(e)}function Z(e){R(e),W(JSON.stringify(e)),localStorage.setItem("chat history",JSON.stringify(e))}function Y(e){return new Promise((function(n,a){if("true"===localStorage.getItem("mute_chat"))n();else{var r=[];Array.isArray(e)&&e.map((function(e){e&&e.utterance&&r.push({text:e.utterance}),e&&Array.isArray(e.audio)&&e.audio.map((function(e){e.href&&"true"===e.autoplay&&r.push({audio:e.href,start:e.start,end:e.end})})),e&&Array.isArray(e.video)&&e.video.map((function(e){e.href&&"true"===e.autoplay&&r.push({video:e.href,start:e.start,end:e.end})}))})),function e(n){return new Promise((function(a,s){var i;"true"===localStorage.getItem("mute_chat")?a():r.length>0?(i=n[0],new Promise((function(e,n){var a;if("true"===localStorage.getItem("mute_chat"))e();else if(d.stop(),i&&i.text)d.speak(i.text,{},(function(){e()}));else if(i&&i.audio)(F=new Audio(i.audio)).onended=function(){e()},F.onerror=function(){e()},F.onloadedmetadata=function(){i.start>0&&(F.currentTime=i.start)},F.ontimeupdate=function(){b.slot("audioPlayerCurrentTime",F.currentTime),i.end>0&&F.currentTime>i.end&&F.pause()},F.loop=!1,F.play();else if(i&&i.video){var r=i&&i.video?void 0!==(a=(a=i.video).split(/(vi\/|v%3D|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]?a[2].split(/[^0-9a-z_\-]/i)[0]:a[0]:"";if(r){function s(){T(null),e()}T({start:i.start,end:i.end,autostart:i.autostart,onEnd:s,onError:s,youtubeVideoId:r})}else I(i),t&&t.current?(t.current.onended=function(){I(null),e()},t.current.onerror=function(){I(null),e()},t.current.ontimeupdate=function(){b.slot("videoPlayerCurrentTime",t.current.currentTime),i.end>0&&t.current.currentTime>i.end&&t.current.pause()},t.current.play()):e()}else e()}))).then((function(){var t=n.slice(1);t.length>0&&!k?e(t).then((function(){a()})):a()})):a()}))}(r).then((function(){console.log("HAN spoken"),n()}))}}))}function Q(e){var t=Array.isArray(j)?j:[];t.push({user:e,bot:[]}),Z(t),window.scrollTo(0,0),b&&b.run&&b.run(e).then((function(e){H(" ")}))}function X(e){T(null),I(null);var t=[];try{t=JSON.parse(localStorage.getItem("chat history"))}catch(r){console.log(r)}var n=t.length>0?t[t.length-1]:{user:"",bot:[]};n.user||(n.user="");var a=n&&n.bot?n.bot:[];return a.push(e),n.bot=a,t.length>0?t[t.length-1]=n:t.push(n),Z(t),Y([e])}Object(a.useEffect)(()=>{var e=localStorage.getItem("mute_chat");O("true"===e)},[]),Object(a.useEffect)(()=>{D&&(Z([]),c(!1),new Promise((function(e,t){Z([]);var n=f()(D||{});n.handleBotMessage=X,w(n),c(!0),n.init().then((function(t){c(!0),e([])}))})))},[D]);var q={position:"relative",backgroundColor:"grey",border:"2px solid black",borderRadius:"2em",height:"3em",width:"3em",textDecoration:"none",outline:"none",padding:"0.2em"},G={position:"relative",backgroundColor:e.color?e.color:"grey",border:"2px solid black",borderRadius:"2em",height:"3em",width:"3em",textDecoration:"none",outline:"none"};return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),Q(B)}},r.a.createElement("div",{style:{backgroundColor:"lightgrey",position:"fixed",top:0,left:0,width:"100%",border:"2px solid black",padding:"0.3em"}},r.a.createElement("input",{type:"text",style:{marginRight:"1em",width:"75%"},value:B,placeholder:0===j.length?"Start a conversation":"",onChange:function(e){H(e.target.value)}}),r.a.createElement(m,{style:G,onMessage:function(e){H(e),Q(e)}}),!k&&r.a.createElement(l.a,{variant:"primary",style:Object.assign({},q,{marginLeft:"1em",backgroundColor:"#90ee9024",borderColor:"green"}),onClick:function(e){U(!0)}},r.a.createElement("div",{style:{position:"relative",width:"90%",top:"-0.4em",left:"-0.1em"}},r.a.createElement("svg",{viewBox:"0 0 31 31"},r.a.createElement("g",{stroke:"black",strokeWidth:"1",fill:"none",fillRule:"evenodd",id:"g8"},r.a.createElement("path",{style:{fill:"#000000",fillRule:"evenodd",stroke:"none",strokeWidth:1},id:"path6",d:"M 6.0093689,15.068946 H 7.9906311 C 8.5480902,15.068946 9,15.504817 9,16.044457 v 7.847427 c 0,0.53876 -0.4433532,0.975512 -1.0093689,0.975512 H 6.0093689 C 5.4519098,24.867396 5,24.431524 5,23.891884 v -7.847427 c 0,-0.53876 0.4433532,-0.975511 1.0093689,-0.975511 z m 4.8355181,-0.526819 8.46047,-5.2754227 C 20.241282,8.6831193 21,9.088977 21,10.174567 v 19.587207 c 0,1.084984 -0.791093,1.541729 -1.755146,1.02648 L 10.881582,26.318412 C 10.394698,26.058191 10,25.411369 10,24.871729 v -8.827272 c 0,-0.53876 0.378645,-1.211611 0.844887,-1.50233 z"}))))),k&&r.a.createElement(l.a,{variant:"primary",style:Object.assign({},q,{marginLeft:"1em",backgroundColor:"#fcbfcb3d",borderColor:"red"}),onClick:function(e){U(!1)}},r.a.createElement("div",{style:{position:"relative",width:"90%",top:"-0.4em",left:"-0.1em"}},r.a.createElement("svg",{viewBox:"0 0 31 31"},r.a.createElement("g",{stroke:"black",strokeWidth:"1",fill:"none",fillRule:"evenodd",id:"g8"},r.a.createElement("path",{d:"M26.8890873,18.5748798 L24.4142136,16.1000061 L23,17.5142197 L25.4748737,19.9890934 L23,22.4639671 L24.4142136,23.8781807 L26.8890873,21.403307 L29.363961,23.8781807 L30.7781746,22.4639671 L28.3033009,19.9890934 L30.7781746,17.5142197 L29.363961,16.1000061 L26.8890873,18.5748798 Z M6.0093689,15.0689455 L7.9906311,15.0689455 C8.54809015,15.0689455 9,15.5048168 9,16.0444571 L9,23.8918841 C9,24.4306443 8.55664682,24.8673958 7.9906311,24.8673958 L6.0093689,24.8673958 C5.45190985,24.8673958 5,24.4315245 5,23.8918841 L5,16.0444571 C5,15.5056969 5.44335318,15.0689455 6.0093689,15.0689455 Z M10.8448866,14.5421268 L19.3053568,9.26670427 C20.2412824,8.68311934 21,9.08897697 21,10.1745672 L21,29.761774 C21,30.8467578 20.2089071,31.3035027 19.244854,30.788254 L10.8815817,26.3184118 C10.3946976,26.0581912 10,25.4113695 10,24.8717291 L10,16.0444571 C10,15.5056969 10.3786449,14.8328461 10.8448866,14.5421268 Z",fill:"#000000",id:"path6"}))))),J&&J.youtubeVideoId&&r.a.createElement("span",{style:{position:"relative",height:"3em",width:"3em",top:"0.7em",marginLeft:"1em"},onClick:function(e){T(null),I(null),F&&F.pause(),F=null}},r.a.createElement("svg",{viewBox:"0 0 34 34 ",x:"0px",y:"0px",style:{height:"3em",width:"3em"}},r.a.createElement("path",{d:"M 21.000009,30.000009 H 9.0000085 a 0.5,0.5 0 0 1 -0.35,-0.15 l -8.49999997,-8.49 A 0.5,0.5 0 0 1 8.527757e-6,21.000009 V 9.0000085 A 0.5,0.5 0 0 1 0.15000853,8.6500085 L 8.6400085,0.15000853 a 0.5,0.5 0 0 1 0.36,-0.150000002243 H 21.000009 a 0.5,0.5 0 0 1 0.35,0.150000002243 l 8.49,8.48999997 a 0.5,0.5 0 0 1 0.16,0.36 V 21.000009 a 0.5,0.5 0 0 1 -0.15,0.35 l -8.49,8.49 a 0.5,0.5 0 0 1 -0.36,0.16 z m -11.8000005,-1 H 20.800009 l 8.2,-8.2 V 9.2000085 l -8.2,-8.2 H 9.2000085 l -8.2,8.2 V 20.800009 Z",id:"path4617",style:{fill:"#fa0010",fillOpacity:1,imageRendering:"auto",stroke:"#dc2500",strokeOpacity:1,opacity:1,strokeWidth:1.8,strokeMiterlimit:4,strokeDasharray:"none"}}),r.a.createElement("text",{style:{fontStyle:"normal",fontWeight:"normal",fontSize:"10.79994011px",lineHeight:1.25,fontFamily:"sans-serif",letterSpacing:"0px",wordSpacing:"0px",fill:"#000000",fillOpacity:1,stroke:"none",strokeWidth:.26999852},x:"3.4542296",y:"15.328075",id:"text5172",transform:"scale(0.75898724,1.3175452)"},r.a.createElement("tspan",{id:"tspan5170",x:"3.4542296",y:"15.328075",style:{fontStyle:"normal",fontVariant:"normal",fontWeight:"bold",fontStretch:"normal",fontSize:"10.79994011px",fontFamily:"sans-serif",fontVariantLigatures:"normal",fontVariantCaps:"normal",fontVariantNumeric:"normal",fontFeatureSettings:"normal",textAlign:"start",writingMode:"lr-tb",textAnchor:"start",strokeWidth:.26999852}},"STOP"))))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null)),C&&r.a.createElement("div",null,r.a.createElement("br",null)," ",r.a.createElement("br",null)," ",r.a.createElement("video",{ref:t,id:"myVid",width:"100%"},r.a.createElement("source",{src:C}),"Sorry, your browser does not support HTML5 video.")),J&&J.youtubeVideoId&&r.a.createElement("div",{style:{width:"100%"}},r.a.createElement("br",null),r.a.createElement("br",null),"  ",r.a.createElement(u.a,{key:"yt-fs",videoId:J.youtubeVideoId,opts:{width:"100%",playerVars:{start:J.start,end:J.end,controls:1,autoplay:1}},onEnd:J.onEnd,onError:J.onError,onPause:J.onPause})),r.a.createElement(a.Fragment,null,r.a.createElement("span",{style:{display:i?"block":"none"}},r.a.createElement(p,{fullScreenVideo:C,fullScreenYoutube:J,jsonhistory:JSON.stringify(j),history:j,sendUserMessage:Q})),!i&&r.a.createElement("b",{style:{padding:"1em",marginTop:"5em"}},"Loading")))}var y=n(280);window.skill&&(y=window.skill),console.log(["CHAT APP ",y]);var g=()=>r.a.createElement("div",null,r.a.createElement(h,{currentSkill:y,isFullScreen:!0}));i.a.render(r.a.createElement(g,null),document.getElementById("root"))}},[[145,1,2]]]);